!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(t["js-flock"]={})}(this,function(t){"use strict";var r=Object.freeze({isStrangled:!0,message:"Promise have timed out"}),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t){return!(!t||"object"!==(void 0===t?"undefined":e(t))&&"function"!=typeof t||!Object.prototype.hasOwnProperty.call(t,"constructor")||"function"!=typeof t.constructor||!Function.prototype.toString.call(t.constructor).includes("[native code]"))},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function t(r,e,i){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(u.has(e))return e;if(i=i||{},Object[r](e),u.add(e),e===Function.prototype)return e;var f=Object.getOwnPropertyNames(e);if(Object.getOwnPropertySymbols&&(f=f.concat(Object.getOwnPropertySymbols(e))),f.forEach(function(n){var f=e[n];!f||"object"!==(void 0===f?"undefined":o(f))&&"function"!=typeof f||"undefined"==typeof ArrayBuffer||ArrayBuffer.isView(f)||"function"==typeof i.exclude&&i.exclude(n,e)||t(r,f,i,u)}),i.proto){var c=Object.getPrototypeOf(e);c&&!n(c)&&t(r,c,i,u)}return e},u=function(t){return function(r,e){var n=Object.prototype.toString.call(e);if("[object "+r+"]"!==n)throw new TypeError(t+": expected ["+r+"] but got "+n+"]")}},f=function(t,r){return r={exports:{}},t(r,r.exports),r.exports}(function(t){var r=u("promisify"),e=Symbol("promisified"),o=function(t,r,e){var n=this;return new Promise(function(o,i){r.push(function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),u=1;u<r;u++)n[u-1]=arguments[u];return t?i(t):o(e&&e.multiArgs?n:n[0])}),t.apply(n,r)})},i=function(t,r,n){return"function"==typeof t&&!0!==t[e]&&(!n||n.some(function(r){return r===t.name}))&&(!r||r.every(function(r){return r!==t.name}))},f=function(t,e){return r("Function",t),function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return o.call(this,t,n,e)}};f.all=function(t,o){r("Object",t);var u=o||{},c=u.suffix,a=u.exclude,s=u.include,y=u.proto;if(c="string"==typeof c?c:"Async",a=Array.isArray(a)?a:void 0,s=Array.isArray(s)?s:void 0,Object.getOwnPropertyNames(t).forEach(function(r){if(i(t[r],a,s)){for(var n=""+r+c;n in t;){if(!0===t[n][e])return;n+="Promisified"}t[n]=f(t[r],o),t[n][e]=!0}}),y){var l=Object.getPrototypeOf(t);l&&!n(l)&&f.all(l,o)}return t},t.exports=f}),c=u("rerun"),a=function(){function t(t,r){var e=[],n=!0,o=!1,i=void 0;try{for(var u,f=t[Symbol.iterator]();!(n=(u=f.next()).done)&&(e.push(u.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&f.return&&f.return()}finally{if(o)throw i}}return e}return function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return t(r,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y=function(t,r,e){return r===e?0:r<e?-t:null==r?1:null==e?-1:t},l=function(t,r,e,n){return y(t,e[r],n[r])},p=function(t,r,e,n){return y(t,r(e),r(n))},d=function(t,r,e,n,o,i){return h(t(o),t(i),r,e,n,o,i)},v=function(t,r,e,n,o,i){return h(o[t],i[t],r,e,n,o,i)},b=function(t,r,e,n,o,i){var u=t.asc||t.desc,f=t.asc?1:-1;if(!u)throw Error("sort: Invalid 'by' sorting onfiguration.\n      Expecting object with 'asc' or 'desc' key");return m(u)(u,r,e,f,o,i)},m=function(t){var r=void 0===t?"undefined":s(t);return"string"===r?v:"function"===r?d:b},h=function(t,r,e,n,o,i,u){return t===r||null==t&&null==r?e.length>n?m(e[n])(e[n],e,n+1,o,i,u):0:y(o,t,r)},S=function(t,r,e){if(!Array.isArray(r))return r;Array.isArray(e)&&e.length<2&&(e=a(e,1)[0]);var n=void 0;return n=e?"string"==typeof e?l.bind(void 0,t,e):"function"==typeof e?p.bind(void 0,t,e):m(e[0]).bind(void 0,e.shift(),e,0,t):y.bind(void 0,t),r.sort(n)},g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w=function(t){if(Array.isArray(t)){var r={};return t.forEach(function(t){r[t]=Symbol(t)}),r}return"object"===(void 0===t?"undefined":g(t))?Object.assign({},t):{}},A=function(t){return/^class /.test(Function.prototype.toString.call(t))},j=function(t,r){var e=t[r];"function"!=typeof e||A(e)||(t[r]=e.bind(t))},O=u("waitFor"),E={collar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,n=new Promise(function(t,n){return setTimeout(n,e,r)});return Promise.race([n,t])},deepFreeze:function(t,r){return i("freeze",t,r)},deepPreventExtensions:function(t,r){return i("preventExtensions",t,r)},deepSeal:function(t,r){return i("seal",t,r)},empty:function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];return r.forEach(function(t){Array.isArray(t)&&t.splice(0,t.length)}),1===r.length?r[0]:r},last:function(t,r){var e=Array.isArray(t)?t.length:0;if(e){if("function"!=typeof r)return t[e-1];for(;--e;)if(r(t[e]))return t[e]}},promisify:f,rerun:function(t){function r(){n||u&&!u(e)||(e+=1,!1===t())?o&&o(e):setTimeout(r,i)}c("Function",t);var e=0,n=void 0,o=void 0,i=void 0,u=void 0;return{every:function(t){if(t=Number(t),c("Number",t),!(t>=0))throw Error("rerun: every() need to be called with positive number");return i=t,this},asLongAs:function(t){return c("Function",t),u=t,this},start:function(){if(void 0===i)throw Error("rerun: every() is required before calling start()");return n=!1,r(),this},stop:function(){return n=!0,this},onStop:function(t){return c("Function",t),o=t,this}}},singular:function(t){var r=!1,e=function(){return r=!1};return function(){if(!r){r=!0;for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];o.unshift(e),t.apply(this,o)}}},sort:function(t){return{asc:function(r){return S(1,t,r)},desc:function(r){return S(-1,t,r)},by:function(r){if(!Array.isArray(t))return t;if(!Array.isArray(r))throw Error("sort: Invalid usage of 'by' sorter. Array syntax is required.\n          Did you mean to use 'asc' or 'desc' sorter instead?");if(1===r.length){var e=r[0].asc?1:-1,n=r[0].asc||r[0].desc;if(!n)throw Error("sort: Invalid 'by' sorting onfiguration.\n            Expecting object with 'asc' or 'desc' key");return S(e,t,n)}var o=b.bind(void 0,r.shift(),r,0,void 0);return t.sort(o)}}},toEnum:function(t){var r=w(t),e=Object.keys(r).filter(function(t){return"function"!=typeof r[t]}),n=e.map(function(t){return r[t]});if(new Set(n).size!==n.length)throw new TypeError("toEnum: Duplicate values detected");Object.freeze(e),Object.freeze(n),Object.keys(r).forEach(function(t){return j(r,t)});var o={keySet:void 0,valueSet:void 0};return r.keys=function(){return e},r.values=function(){return n},r.haveKey=function(t){return o.keySet=o.keySet||new Set(e),o.keySet.has(t)},r.exists=function(t){return o.valueSet=o.valueSet||new Set(n),o.valueSet.has(t)},Object.freeze(r)},waitFor:function(t,r){O("Function",t);var e=Number(r&&r.interval)||50,n=Date.now()+(Number(r&&r.timeout)||5e3);return new Promise(function(r,o){var i=!1,u=function(){return i=!0};!function f(){var c=t(u);if(!i)return c?r(c):Date.now()>n?o(new Error("Timed out!")):void setTimeout(f,e)}()})}},x=E.collar,P=E.deepFreeze,F=E.deepPreventExtensions,k=E.deepSeal,z=E.empty,T=E.last,N=E.promisify,D=E.rerun,I=E.singular,q=E.sort,B=E.toEnum,_=E.waitFor;t.default=E,t.collar=x,t.deepFreeze=P,t.deepPreventExtensions=F,t.deepSeal=k,t.empty=z,t.last=T,t.promisify=N,t.rerun=D,t.singular=I,t.sort=q,t.toEnum=B,t.waitFor=_,Object.defineProperty(t,"__esModule",{value:!0})});
